<template>
    <div class="slds-var-p-around_medium">
        <div class="title-medium slds-m-bottom_medium">
            {labels.loyaltyTiers}
        </div>

        <div if:true={rewardsInfo} class="box slds-text-align_center slds-p-around_small slds-m-bottom_medium">
            <div class="main-avatar-container">
                <span class="loyalty-badge">
                    <c-loyalty-tier-badge width="24px" height="24px" loyalty-tier-name={rewardsInfo.currentLoyaltyLevel}></c-loyalty-tier-badge>
                </span>
                <lightning-avatar variant="circle" src={photoUrl} fallback-icon-name="standard:user" size="large"></lightning-avatar>
            </div>

            <div class="slds-m-bottom_x-small"><strong>{rewardsInfo.donorName}</strong></div>
            <div class="slds-m-bottom_x-small" style="font-size: 1.33rem; font-weight: 600; color: #983285;">{rewardsInfo.currentLoyaltyLevel}</div>
            
            <lightning-formatted-rich-text value={getRemainingVisitsForNextTierText}></lightning-formatted-rich-text>
            <!-- <div><strong>{rewardsInfo.remainingVisitsForNextTier} Appointments</strong> to get <strong><span style="color: #A18B76;">{rewardsInfo.nextLoyaltyLevel}</span></strong> status</div> -->
        </div>

        <div class="title-small slds-m-bottom_small">
            {labels.trackYourProgress}
        </div>
        <div class="slds-m-bottom_medium">
            {labels.promotionChartDescription}
        </div>

        <div class="legend slds-m-bottom_medium">
            <canvas style="width: 90%;" data-loyalty-tier-chart>
            </canvas>
        </div>

        <div class="title-small slds-m-bottom_small">
            {labels.rewardsExplained}
        </div>

        <div class="slds-m-bottom_small">
            {labels.rewardsExplanation}
        </div>

        <template if:true={loyaltyLevels}>
            <template for:each={loyaltyLevels} for:item="loyaltyTier">
                <div key={loyaltyTier.levelName}>
                    <div class="tier slds-m-bottom_large">
                        <c-loyalty-tier-badge width="64" height="64" loyalty-tier-name={loyaltyTier.levelName}></c-loyalty-tier-badge>

                        <div class="tier-name slds-m-left_x-small" style="color: #8979A9;">
                            <strong>{loyaltyTier.levelName}</strong>
                            <span style="font-size: 12px;">
                                <span> - </span>

                                <lightning-formatted-number maximum-fraction-digits="0" format-style="currency" currency-code="USD" value={loyaltyTier.loyaltyPointsPerDonation}></lightning-formatted-number>
                                <span style="margin-left: 0.25rem;">{labels.perDonation}</span>

                                <span style="margin: 0 0.25rem;">&amp;</span> 

                                {loyaltyTier.loyaltyCurrencyPerDonation} {labels.pointBrandName}
                            </span>
                        </div>
                    </div>
        
                    <div class="slds-m-bottom_small">
                        {loyaltyTier.levelDescription}
                    </div>
                </div>
            </template>
        </template>
    </div>
</template>